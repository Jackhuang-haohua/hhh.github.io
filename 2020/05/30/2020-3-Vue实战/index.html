<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/hhh.github.io/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/hhh.github.io/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/hhh.github.io/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/hhh.github.io/images/logo.svg" color="#222">

<link rel="stylesheet" href="/hhh.github.io/css/main.css">


<link rel="stylesheet" href="/hhh.github.io/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://github.com/Jackhuang-haohua/jackhuang-haohua.github.io').hostname,
    root: '/hhh.github.io/',
    scheme: 'Gemini',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"default"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: true,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="其实也不算项目，就是用vue还原一个网站">
<meta property="og:type" content="article">
<meta property="og:title" content="VUE项目实战">
<meta property="og:url" content="https://github.com/Jackhuang-haohua/jackhuang-haohua.github.io/2020/05/30/2020-3-Vue%E5%AE%9E%E6%88%98/index.html">
<meta property="og:site_name" content="浩华好哇的小站">
<meta property="og:description" content="其实也不算项目，就是用vue还原一个网站">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-05-30T11:56:11.000Z">
<meta property="article:modified_time" content="2020-04-25T10:23:57.292Z">
<meta property="article:author" content="浩华好哇">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://github.com/Jackhuang-haohua/jackhuang-haohua.github.io/2020/05/30/2020-3-Vue%E5%AE%9E%E6%88%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>VUE项目实战 | 浩华好哇的小站</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">
<link rel="alternate" href="/hhh.github.io/atom.xml" title="浩华好哇的小站" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/hhh.github.io/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">浩华好哇的小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/hhh.github.io/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tools">

    <a href="/hhh.github.io/tools/" rel="section"><i class="fa fa-fw fa-briefcase"></i>工具</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/hhh.github.io/categories/" rel="section"><i class="fa fa-fw fa-list"></i>分类</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/hhh.github.io/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Jackhuang-haohua/jackhuang-haohua.github.io/2020/05/30/2020-3-Vue%E5%AE%9E%E6%88%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/hhh.github.io/images/%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="浩华好哇">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="浩华好哇的小站">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          VUE项目实战
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-05-30 19:56:11" itemprop="dateCreated datePublished" datetime="2020-05-30T19:56:11+08:00">2020-05-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-25 18:23:57" itemprop="dateModified" datetime="2020-04-25T18:23:57+08:00">2020-04-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/hhh.github.io/categories/Vue/" itemprop="url" rel="index">
                    <span itemprop="name">Vue</span>
                  </a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>31k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>56 分钟</span>
            </span>
            <div class="post-description">其实也不算项目，就是用vue还原一个网站</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h1><p><a href="https://m.maizuo.com/v5/#/films/nowPlaying" target="_blank">卖座电影</a><br>我是图片<br>只做一部分，重复的内容就不做了</p>
<h1 id="vue-cli"><a href="#vue-cli" class="headerlink" title="vue-cli"></a>vue-cli</h1><blockquote>
<p>前端工程化开发项目是主流，我们需要搭建vue开发环境，一般会选择webpack进行项目的构建；</p>
</blockquote>
<h2 id="安装vue-cli"><a href="#安装vue-cli" class="headerlink" title="安装vue-cli"></a>安装vue-cli</h2><p><code>npm install -g @vue/cli</code>或者<code>yarn global add @vue/cli</code><br>输入<code>vue -v</code>检测是否安装成功</p>
<h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><p>一、新建项目文件夹maizuo(卖座)，在vscode中打开，在左边栏里右键=&gt;在终端打开<br>二、输入<code>vue create 文件名</code>命令表示在maizuo文件夹里创建又一个项目文件夹，也可以直接<code>vue create .</code>在当前文件夹创建，之后会有几个选项：<br>1.Generate project in current directory? (Y/n) =&gt; 在当前文件夹创建吗 =&gt; y</p>
<p>2.default (babel, eslint) =&gt; 安装默认插件 / Manually select features =&gt; 自己决定安装哪些插件 =&gt; 选择第二个</p>
<p>3.上下键+空格进行操作，回车确定，先安装标注说明的5个插件<br> ( ) Babel =&gt; 使项目可以支持es6语法<br> ( ) TypeScript<br> ( ) Progressive Web App (PWA) Support<br> ( ) Router =&gt; 路由用到的插件<br> ( ) Vuex =&gt; 状态管理<br> ( ) CSS Pre-processors =&gt; css插件<br> ( ) Linter / Formatter =&gt; 代码规范化<br> ( ) Unit Testing<br> ( ) E2E Testing</p>
<p> 4.Use history mode for router? =&gt; 是否使用路由模式 =&gt; y</p>
<p> 5.css预编译插件，选第一个；sass安装不上的话，试试<code>cnpm i node-sass</code></p>
<p> 6.ESLint模式，选默认的第一个，ESLint with error prevention only / Lint on save；</p>
<p> 7.Where do you prefer placing config for Babel, ESLint, etc.? =&gt; 配置是要单独一个文件夹还是放在package.json里？ =&gt; 选第一个</p>
<p> 8.Save this as a preset for future projects? =&gt; 保存这次的预设吗？ =&gt; y =&gt; Save preset as:预设的名字</p>
<p> 9.项目相关指令<br> npm run serve 开发环境构建，运行项目<br> ​npm run build 生产环境构建，生成可上线的dist文件夹<br> npm run lint 代码检测工具</p>
<h1 id="vue-config配置"><a href="#vue-config配置" class="headerlink" title="vue.config配置"></a>vue.config配置</h1><p> 我们需要配置一些信息</p>
<h2 id="eslint"><a href="#eslint" class="headerlink" title="eslint"></a>eslint</h2><p> 1.代码检测工具，安装后，代码不符合规范则会弹出警告窗，<br> 2.可在根路径下新建vue.config.js文件修改配置，如下：<br> <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    open: <span class="literal">true</span>, <span class="comment">//默认开启浏览器</span></span><br><span class="line">    port: <span class="number">8000</span>, <span class="comment">//更改默认端口号为8000</span></span><br><span class="line">    overlay: &#123; <span class="comment">// eslint遮罩层</span></span><br><span class="line">      warnings: <span class="literal">false</span>,</span><br><span class="line">      errors: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  lintOnSave: <span class="literal">false</span>, <span class="comment">//直接关闭eslint检查</span></span><br><span class="line">&#125;</span><br><span class="line"> <span class="number">3.</span>相关规则可在.eslintrc.js文件修改，但不建议修改，因为要统一规范，例如：</span><br><span class="line"><span class="string">``</span><span class="string">`.eslintrc.js</span></span><br><span class="line"><span class="string">rules: &#123;</span></span><br><span class="line"><span class="string">  'quotes':'off',   //关闭eslint引号验证</span></span><br><span class="line"><span class="string">  'key-spacing':'off', //关闭关键词前面空格的验证</span></span><br><span class="line"><span class="string">  'no-console': process.env.NODE_ENV === 'production' ? 'error' : 'off',</span></span><br><span class="line"><span class="string">  'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'off'</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure></div><br> 4.规范文章<a href="https://www.cnblogs.com/mingjian/p/9361027.html" target="_blank">明济安的博客</a></p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2> <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    open: <span class="literal">true</span>, <span class="comment">//默认开启浏览器</span></span><br><span class="line">    port: <span class="number">8000</span>, <span class="comment">//更改默认端口号为8000</span></span><br><span class="line">    overlay: &#123; <span class="comment">// 遮罩层</span></span><br><span class="line">      warnings: <span class="literal">false</span>,</span><br><span class="line">      errors: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//代理配置，这里是登录页面要用到</span></span><br><span class="line">    proxy: &#123;</span><br><span class="line">      <span class="string">"/info"</span>: &#123;</span><br><span class="line">        target: <span class="string">"http://47.104.70.82:3000"</span>,</span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">"^/info"</span>: <span class="string">""</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// alias别名配置，</span></span><br><span class="line">  <span class="comment">// 配置后，src/views/xxx 可以写成 @/views/xxx</span></span><br><span class="line">  configureWebpack: &#123;</span><br><span class="line">    resolve: &#123;</span><br><span class="line">      alias: &#123;</span><br><span class="line">        <span class="string">'assets'</span>: <span class="string">'@/assets'</span>,</span><br><span class="line">        <span class="string">'con'</span>: <span class="string">'@/components'</span>,</span><br><span class="line">        <span class="string">'views'</span>: <span class="string">'@/views'</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// bulid打包路径配置</span></span><br><span class="line">  publicPath: <span class="string">'/vue-demo'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="移动端注意事项"><a href="#移动端注意事项" class="headerlink" title="移动端注意事项"></a>移动端注意事项</h1><p>1.单位<br>我们在PS里量到的100px为逻辑像素，但手机的物理像素各不相同，因此要换个能适配的单位</p>
<ul>
<li>src/utils中创建rem.js，内容如下：<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.documentElement.style.fontSize =</span><br><span class="line">  <span class="built_in">document</span>.documentElement.clientWidth / <span class="number">3.75</span> + <span class="string">"px"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.onresize = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">document</span>.documentElement.style.fontSize =</span><br><span class="line">    <span class="built_in">document</span>.documentElement.clientWidth / <span class="number">3.75</span> + <span class="string">"px"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></li>
<li>src/main.js中引入，<code>import &quot;@/utils/rem&quot;</code></li>
<li>此后，我们量到100px，样式中写1rem即可</li>
</ul>
<p>2.其他还没总结</p>
<h1 id="配置路由"><a href="#配置路由" class="headerlink" title="配置路由"></a>配置路由</h1><p>分为两部分来讲</p>
<h2 id="简单配置"><a href="#简单配置" class="headerlink" title="简单配置"></a>简单配置</h2><p>1.现在许多应用都是SPA应用（single page application），就是切换内容时浏览器不刷新，页面局部刷新，用户体验更好；<br>Vue中可以通过官方提供的vue-router插件来实现单页面，原理就是通过检测地址栏变化后将对应的路由组件进行切换（卸载和安装）；</p>
<p>2.SPA vs MPA<br>spa图片</p>
<p>3.简单实现<br>1)cnpm install vue-router -S 或者 yarn add vue-router -S 安装vue-router<br>2)src/views中，新建flims.vue；src/App.vue中，template&gt;div，加上<code>&lt;router-view&gt;&lt;/router-view&gt;</code><br>3)src/router/index.js中</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.引入插件</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.引入组件，与路由配对</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./../App.vue'</span></span><br><span class="line"><span class="keyword">import</span> films <span class="keyword">from</span> <span class="string">'./../views/films/films.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.让Vue使用VueRouter，内部使用了install完成</span></span><br><span class="line">Vue.use(VueRouter)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.配置路由</span></span><br><span class="line"><span class="keyword">const</span> routes = [&#123;</span><br><span class="line">    <span class="comment">// 根路由，即输入localhost:8000，会打开App.vue</span></span><br><span class="line">    path: <span class="string">'/'</span>,</span><br><span class="line">    component: App,</span><br><span class="line">    <span class="comment">// 根路由的子路由</span></span><br><span class="line">    children: [&#123;</span><br><span class="line">        path: <span class="string">'/films'</span>,</span><br><span class="line">        component: films,</span><br><span class="line">      &#125;]</span><br><span class="line">  &#125;]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5.实例化对象</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6.暴露路由</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure></div>

<p>4)src/main.js中</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router'</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  router, <span class="comment">//注册router，各组件就能就能用$router</span></span><br><span class="line">  store, <span class="comment">//各组件就能用$store</span></span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></table></figure></div>

<p>5)此时，yarn serve启动服务，输入localhost:8000，就会打开App.vue，而App.vue中的<code>&lt;router-view&gt;&lt;/router-view&gt;</code>则是films.vue的插槽</p>
<h2 id="路由完善"><a href="#路由完善" class="headerlink" title="路由完善"></a>路由完善</h2><h3 id="1-路由懒加载"><a href="#1-路由懒加载" class="headerlink" title="1.路由懒加载"></a>1.路由懒加载</h3><p>懒加载也叫延迟加载，即在需要的时候进行加载，随用随载。在单页应用中，如果没有应用懒加载，运用webpack打包后的文件将会异常的大，造成进入首页时，需要加载的内容过多，延时过长，不利于用户体验，而运用懒加载则可以将页面进行划分，需要的时候加载页面，可以有效的分担首页所承担的加载压力，减少首页加载用时。<br>非按需加载则会把所有的路由组件块的js包打在一起。当业务包很大的时候建议用路由的按需加载（懒加载）。<br>按需加载会在页面第一次请求的时候，把相关路由组件块的js添加上；</p>
<p>简单来说，但我们点进带有flims组件的部分时，这个组件才会加载，在Network可以找到film.js<br>src/router/index.js中，代码如下：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path: <span class="string">'/films'</span>,</span><br><span class="line">    component: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>( <span class="comment">/*webpackChunkName:'film'*/</span> <span class="string">"@/views/films"</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>更多内容参见：<a href="https://www.cnblogs.com/lijuntao/p/7777581.html" target="_blank">涛叔的博客</a></p>
<h3 id="2-多级路由"><a href="#2-多级路由" class="headerlink" title="2.多级路由"></a>2.多级路由</h3><p>就是配置路由时的children，父组件中通过<code>&lt;router-view&gt;</code>来指定子组件的位置，不再详细展开。</p>
<h3 id="3-默认路由-命名路由-路由重定向"><a href="#3-默认路由-命名路由-路由重定向" class="headerlink" title="3.默认路由/命名路由/路由重定向"></a>3.默认路由/命名路由/路由重定向</h3><p>src/router/index.js中：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认路由：</span></span><br><span class="line"><span class="comment">// 之前设置的路由都不满足，如http://localhost:8000/#/123则会进入error.vue</span></span><br><span class="line"><span class="comment">// 即App.vue的插槽中插入error组件，</span></span><br><span class="line">&#123;</span><br><span class="line">  path: <span class="string">"*"</span>,</span><br><span class="line">  component: <span class="built_in">Error</span></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 命名路由</span></span><br><span class="line"><span class="comment">// 在其他组件中，&lt;router-link :to="&#123;name:'todetail',params:&#123;id:film.filmId&#125;&#125;"&gt;跳转到detail&lt;/router-link&gt;</span></span><br><span class="line"><span class="comment">// 即App.vue中插入films组件，films组件中插入detail组件</span></span><br><span class="line">&#123;</span><br><span class="line">  name: <span class="string">'todetail'</span>,</span><br><span class="line">  path: <span class="string">'/films/detail/:id'</span>,</span><br><span class="line">  component: detail</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// 路由重定向，redirect</span></span><br><span class="line"><span class="comment">// 即输入localhost:8000/#/flims，自动变成localhost:8000/#/flims/now</span></span><br><span class="line">&#123;</span><br><span class="line">  path: <span class="string">'/films'</span>,</span><br><span class="line">  component: films,</span><br><span class="line">  children: [&#123;</span><br><span class="line">    path: <span class="string">'/films/now'</span>,</span><br><span class="line">    component: now</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    path: <span class="string">"/"</span>,</span><br><span class="line">    redirect: <span class="string">"/films/now"</span></span><br><span class="line">  &#125;],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="4-动态路由"><a href="#4-动态路由" class="headerlink" title="4.动态路由"></a>4.动态路由</h3><p>和上面的命名路由配合，列表页跳到详情页时使用</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/index.js中</span></span><br><span class="line">&#123;</span><br><span class="line">  name: <span class="string">'todetail'</span>,</span><br><span class="line">  path: <span class="string">'/films/detail/:id'</span>,</span><br><span class="line">  component: detail</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/views/flims.vue中</span></span><br><span class="line"><span class="comment">// 设置完后，点击这个div就会跳转到 /films/detail/12345</span></span><br><span class="line">&lt;router-link</span><br><span class="line">    <span class="class"><span class="keyword">class</span></span>=<span class="string">"films_now"</span></span><br><span class="line">    v-<span class="keyword">for</span>=<span class="string">"film in filmlist"</span></span><br><span class="line">    :key=<span class="string">"film.filmId"</span></span><br><span class="line">    :to=<span class="string">"&#123;</span></span><br><span class="line"><span class="string">      name:'todetail',</span></span><br><span class="line"><span class="string">      params:&#123;id:film.filmId&#125;</span></span><br><span class="line"><span class="string">    &#125;"</span></span><br><span class="line">    tag=<span class="string">"div"</span></span><br><span class="line">  &gt;<span class="xml"><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// src/views/detail.vue中</span></span><br><span class="line"><span class="keyword">this</span>.$route.params.id 就能得到<span class="number">12345</span></span><br></pre></td></tr></table></figure></div>
<p>假如film.filmId为12345，我们就会跳到/films/detail/12345页面；<br>在src/views/detail.vue中，this.$route.params.id 就能得到12345，但这样获取参数有点长，我们也可以：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/index.js中，增加props</span></span><br><span class="line">&#123;</span><br><span class="line">  name: <span class="string">'todetail'</span>,</span><br><span class="line">  path: <span class="string">'/films/detail/:id'</span>,</span><br><span class="line">  component: detail,</span><br><span class="line">  props:<span class="literal">true</span></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/views/flims.vue中，不变</span></span><br><span class="line">&lt;router-link</span><br><span class="line">    <span class="class"><span class="keyword">class</span></span>=<span class="string">"films_now"</span></span><br><span class="line">    v-<span class="keyword">for</span>=<span class="string">"film in filmlist"</span></span><br><span class="line">    :key=<span class="string">"film.filmId"</span></span><br><span class="line">    :to=<span class="string">"&#123;</span></span><br><span class="line"><span class="string">      name:'todetail',</span></span><br><span class="line"><span class="string">      params:&#123;id:film.filmId&#125;</span></span><br><span class="line"><span class="string">    &#125;"</span></span><br><span class="line">    tag=<span class="string">"div"</span></span><br><span class="line">  &gt;<span class="xml"><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// src/views/detail.vue中，props接收</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">      props:[<span class="string">'id'</span>]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(id) =&gt; <span class="number">12345</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="5-路由跳转"><a href="#5-路由跳转" class="headerlink" title="5.路由跳转"></a>5.路由跳转</h3><p>1)声明式导航，当被激活时，会自动添加router-link-active类名</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link</span><br><span class="line">      <span class="comment">//跳转到哪</span></span><br><span class="line">      :to=<span class="string">"&#123;</span></span><br><span class="line"><span class="string">        //也可以用path来指定路径，但这样就不能使用params传参</span></span><br><span class="line"><span class="string">        name:'todetail',</span></span><br><span class="line"><span class="string">        //this.$route.params.id获取params</span></span><br><span class="line"><span class="string">        params:&#123;id:film.filmId&#125;,</span></span><br><span class="line"><span class="string">        //传queryString参数</span></span><br><span class="line"><span class="string">        query:&#123;content:123&#125;</span></span><br><span class="line"><span class="string">      &#125;"</span></span><br><span class="line">      <span class="comment">//渲染成div标签</span></span><br><span class="line">      tag=<span class="string">"div"</span></span><br><span class="line">      <span class="comment">//跳转时不被记录   </span></span><br><span class="line">      replace:<span class="literal">false</span></span><br><span class="line">    &gt;<span class="xml"><span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div>
<p>2)编程式导航<br>在组件中使用，this.$router.push(“/films”)</p>
<h3 id="6-路由模式"><a href="#6-路由模式" class="headerlink" title="6.路由模式"></a>6.路由模式</h3><p>hash：导航栏里会出现#号，window.onhashchange监听路径的切换<br>history：会出现404 的情况，window.onpopstate监听路径的切换<br>详见：<a href="https://www.cnblogs.com/leyan/p/8677274.html" target="_blank">雪昀的博客</a></p>
<h3 id="7-路由守卫"><a href="#7-路由守卫" class="headerlink" title="7.路由守卫"></a>7.路由守卫</h3><p>当进入某个路由前、后，我们需要做某些操作，比如进入购物车时判断是否登录；这时候就需要钩子函数监听路由变化了</p>
<h4 id="全局路由钩子"><a href="#全局路由钩子" class="headerlink" title="全局路由钩子"></a>全局路由钩子</h4><p>src/router/index.js中，放在最外面，</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断每次进入/mine时，是否有token令牌</span></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.path === <span class="string">"/mine"</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (localStorage.getItem(<span class="string">"token"</span>)) &#123; <span class="comment">//说明用户已经登录了</span></span><br><span class="line">      next()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      next(<span class="string">"/login"</span>) <span class="comment">//如果用户没有登录直接跳转到登录界面进行用户登录</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<h4 id="局部路由钩子"><a href="#局部路由钩子" class="headerlink" title="局部路由钩子"></a>局部路由钩子</h4><p>src/router/index.js中，放const routes里面，</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/foo'</span>,</span><br><span class="line">      component: Foo,</span><br><span class="line">      <span class="comment">//当进入到foo路由之前，就会触发</span></span><br><span class="line">      beforeEnter: <span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        next() <span class="comment">//必须要执行next之后，对应的Foo组件才可以正常显示出来</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br></pre></td></tr></table></figure></div>

<h4 id="路由组件钩子"><a href="#路由组件钩子" class="headerlink" title="路由组件钩子"></a>路由组件钩子</h4><p>放在某个组件中，</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//进入到某个组件之前的拦截，获取不到组件内部的this</span></span><br><span class="line">beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">  <span class="comment">// 在渲染该组件的对应路由被 confirm 前调用</span></span><br><span class="line">  <span class="comment">// 不！能！获取组件实例 `this`</span></span><br><span class="line">  <span class="comment">// 因为当守卫执行前，组件实例还没被创建</span></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">beforeRouteUpdate (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">  <span class="comment">// 在当前路由改变，但是该组件被复用时调用     </span></span><br><span class="line">  <span class="comment">// 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span></span><br><span class="line">  <span class="comment">// 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span></span><br><span class="line">  <span class="comment">// 可以访问组件实例 `this`</span></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">//离开某个组件之前的拦截，获取到组件内部的this</span></span><br><span class="line">beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">  <span class="comment">// 导航离开该组件的对应路由时调用</span></span><br><span class="line">  <span class="comment">// 可以访问组件实例 `this`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="登录与接口"><a href="#登录与接口" class="headerlink" title="登录与接口"></a>登录与接口</h1><p>由于卖座的接口都是开发，所以没有自己模拟接口，除了登录；<br>登录功能难点：</p>
<ul>
<li>node.js模拟接口</li>
<li>接口部署到线上</li>
<li>配置反向代理</li>
<li>请求登录接口</li>
<li>axios拦截配合路由守卫</li>
<li>登录成功后种token</li>
</ul>
<h2 id="1-快速搭建接口"><a href="#1-快速搭建接口" class="headerlink" title="1.快速搭建接口"></a>1.快速搭建接口</h2><p>node.js + express接口已写好，并且上传阿里云服务器</p>
<h2 id="2-反向代理解决跨域问题"><a href="#2-反向代理解决跨域问题" class="headerlink" title="2.反向代理解决跨域问题"></a>2.反向代理解决跨域问题</h2><p>vue.config.js中，配置代理</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    <span class="comment">// 47.104.70.82:3000为自己部署的接口</span></span><br><span class="line">    proxy: &#123;</span><br><span class="line">      <span class="string">"/info"</span>: &#123;</span><br><span class="line">        target: <span class="string">"http://47.104.70.82:3000"</span>,</span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">"^/info"</span>: <span class="string">""</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h2 id="3-拦截"><a href="#3-拦截" class="headerlink" title="3.拦截"></a>3.拦截</h2><p><strong>src/router/index.js中，路由守卫的拦截登录</strong><br>即进入个人中心时判断是否有token，有代表已经登录，没有则跳到登录页面；</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断每次进入/mine的时候，是否有token令牌</span></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.path === <span class="string">"/mine"</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (localStorage.getItem(<span class="string">"token"</span>)) &#123; <span class="comment">//说明用户已经登录了</span></span><br><span class="line">      next()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      next(<span class="string">"/login"</span>) <span class="comment">//如果用户没有登录直接跳转到登录界面进行用户登录</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    next()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<p><strong>src/views/login.vue中，登录</strong><br>来到了登录页面，发送账户密码，登录成功后设置token，去到个人中心</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    login() &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="keyword">this</span>.username.trim() || !<span class="keyword">this</span>.password.trim()) &#123;</span><br><span class="line">        Dialog(&#123;</span><br><span class="line">          message: <span class="string">"用户名或者密码必须要传！"</span>,</span><br><span class="line">          closeOnClickOverlay: <span class="literal">true</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      instance2</span><br><span class="line">        .post(<span class="string">"/api/login"</span>, &#123;</span><br><span class="line">          username: <span class="keyword">this</span>.username,</span><br><span class="line">          password: <span class="keyword">this</span>.password</span><br><span class="line">        &#125;)</span><br><span class="line">        .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">//将token保存到本地存储里面去</span></span><br><span class="line">          localStorage.setItem(<span class="string">"token"</span>, res.token);</span><br><span class="line">          <span class="comment">//跳转到个人中心</span></span><br><span class="line">          <span class="keyword">this</span>.$router.replace(<span class="string">"/mine"</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">          Dialog(&#123; <span class="attr">message</span>: err, <span class="attr">closeOnClickOverlay</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>src/utils/http.js中，封装axios拦截器；</strong><br>这里表示请求数据时，携带token才能得到，比如一些东西登录后才能看到</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">"axios"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//针对于上线的 http://47.96.0.211:3000</span></span><br><span class="line"><span class="keyword">const</span> instance2 = axios.create(&#123;</span><br><span class="line">  baseURL: <span class="string">'/info'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发起请求之前，判断是否有token。如果有则携带在请求头中</span></span><br><span class="line">instance2.interceptors.request.use(</span><br><span class="line">  config =&gt; &#123;</span><br><span class="line">    <span class="comment">// console.log("config", config)</span></span><br><span class="line">    <span class="keyword">if</span> (localStorage.getItem(<span class="string">"token"</span>)) &#123;</span><br><span class="line">      config.headers.token = localStorage.getItem(<span class="string">"token"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应之后的拦截操作，返回结果</span></span><br><span class="line">instance2.interceptors.response.use(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// console.log("res", res)</span></span><br><span class="line">  <span class="keyword">if</span> (res.data.err === <span class="number">0</span>) &#123; <span class="comment">//说明后端给我们前端返回的结果是正常的</span></span><br><span class="line">    <span class="keyword">return</span> res.data</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(res.data.msg)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  instance,</span><br><span class="line">  instance2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>例如：在组件中使用instance2请求，成功则得到res，失败则得到Promise.reject</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">instance2.get(<span class="string">"/api/goods/home"</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"得到res"</span>,res)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"err"</span>,err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<h1 id="首页页面"><a href="#首页页面" class="headerlink" title="首页页面"></a>首页页面</h1><p>主要难点：swiper自定义指令，底部导航栏组件封装，动态id，图片放大插件<br>次要难点：路由配置，点击变橘色</p>
<h2 id="封装swiper"><a href="#封装swiper" class="headerlink" title="封装swiper"></a>封装swiper</h2><h3 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h3><p>src/components/Swiper.vue中，写一个全局组件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;swiper-container&quot; :class&#x3D;&quot;cName&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;swiper-wrapper&quot;&gt;</span><br><span class="line">      &lt;slot&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">&#x2F;&#x2F;引入swiper</span><br><span class="line">import &quot;swiper&#x2F;css&#x2F;swiper.min.css&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  &#x2F;&#x2F; cName为自定义的，轮播图类名</span><br><span class="line">  props: [&quot;cName&quot;]</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure></div>

<h3 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h3><p>src/utils/directives.js中，v-swiper全局指令，实例化swiper插件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line"><span class="keyword">import</span> Swiper <span class="keyword">from</span> <span class="string">"swiper"</span></span><br><span class="line">Vue.directive(<span class="string">"swiper"</span>, &#123;</span><br><span class="line">  inserted(el, binding, vnode) &#123;</span><br><span class="line">    <span class="comment">//代表最后一个元素插入完毕了，再进进行一次实例化操作就可以了</span></span><br><span class="line">    <span class="keyword">let</span> free = binding.value.free ? binding.value.free : <span class="string">''</span></span><br><span class="line">    <span class="keyword">let</span> autoplay = binding.value.autoplay ? binding.value.autoplay : <span class="string">''</span></span><br><span class="line">    <span class="keyword">if</span> (binding.value.current === binding.value.length - <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">new</span> Swiper(<span class="string">"."</span> + binding.value.swipe, &#123; <span class="comment">//默认swiper执行3次，因为插入了3个swiper-slide的真实dom</span></span><br><span class="line">        ...free,</span><br><span class="line">        autoplay,</span><br><span class="line">        loop: <span class="literal">true</span>,</span><br><span class="line">        pagination: &#123;</span><br><span class="line">          el: <span class="string">".swiper-pagination"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<h3 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h3><p>src/views/flims.vue，在组件中使用v-swiper，引用组件=&gt;请求数据=&gt;使用指令并传参</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  &#x2F;&#x2F;1.引入</span><br><span class="line">  import Swiper from &quot;@&#x2F;components&#x2F;Swiper.vue&quot;;</span><br><span class="line">  import &#123; instance, instance2 &#125; from &quot;@&#x2F;utils&#x2F;http&quot;;</span><br><span class="line">  export default &#123;</span><br><span class="line">    components: &#123;</span><br><span class="line">      Swiper &#x2F;&#x2F;注册组件Swiper</span><br><span class="line">    &#125;,</span><br><span class="line">    &#x2F;&#x2F;2.请求数据</span><br><span class="line">    created() &#123;</span><br><span class="line">      instance</span><br><span class="line">        .get(&quot;&#x2F;gateway?type&#x3D;2&amp;cityId&#x3D;310100&amp;k&#x3D;3419992&quot;, &#123;</span><br><span class="line">          headers: &#123;</span><br><span class="line">            &quot;X-Host&quot;: &quot;mall.cfg.common-banner&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .then(res &#x3D;&gt; &#123;</span><br><span class="line">          &#x2F;&#x2F; console.log(res);</span><br><span class="line">          this.banners &#x3D; res.data.data;</span><br><span class="line">          &#x2F;&#x2F; 必须要等到页面中出现了swiper-slide结构后，我们才能进行实例化的操作</span><br><span class="line">          &#x2F;&#x2F; 现在这一步由v-swiper解决了</span><br><span class="line">          this.$nextTick(() &#x3D;&gt; &#123;</span><br><span class="line">            &#x2F;&#x2F; new Swip(&quot;.swiper-container&quot;, &#123;</span><br><span class="line">            &#x2F;&#x2F;   loop: true</span><br><span class="line">            &#x2F;&#x2F; &#125;)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- 3.使用并传参 --&gt;</span><br><span class="line">    &lt;Swiper cName&#x3D;&quot;swipe&quot;&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        class&#x3D;&quot;swiper-slide&quot;</span><br><span class="line">        v-for&#x3D;&quot;(banner,index) in banners&quot;</span><br><span class="line">        :key&#x3D;&quot;banner.bannerId&quot;</span><br><span class="line">        v-swiper&#x3D;&quot;&#123;</span><br><span class="line">          current:index,</span><br><span class="line">          length:banners.length,</span><br><span class="line">          swipe:&#39;swipe&#39;,</span><br><span class="line">          autoplay: &#123;</span><br><span class="line">            delay: 3000,</span><br><span class="line">            stopOnLastSlide: false,</span><br><span class="line">            disableOnInteraction: true,</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;img :src&#x3D;&quot;banner.imgUrl&quot; alt &#x2F;&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;Swiper&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure></div>
<p>之后遇到轮播图，都可以按照 引用组件=&gt;请求数据=&gt;使用指令并传参 这三步来进行<br>注：instance是封装axios的方法</p>
<h2 id="封装底部导航栏"><a href="#封装底部导航栏" class="headerlink" title="封装底部导航栏"></a>封装底部导航栏</h2><h3 id="第一步-组件"><a href="#第一步-组件" class="headerlink" title="第一步-组件"></a>第一步-组件</h3><p>src/components/bottomBar.vue，写局部组件，包括样式和数据</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;nav class&#x3D;&quot;row&quot;&gt;</span><br><span class="line">    &lt;router-link class&#x3D;&quot;col-xs-3&quot; v-for&#x3D;&quot;nav in navlist&quot; :key&#x3D;&quot;nav.id&quot; :to&#x3D;&quot;nav.path&quot; tag&#x3D;&quot;div&quot;&gt;</span><br><span class="line">      &lt;i class&#x3D;&quot;iconfont&quot; :class&#x3D;&quot;nav.icon&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">      &lt;p&gt;&#123;&#123;nav.title&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;&#x2F;router-link&gt;</span><br><span class="line">  &lt;&#x2F;nav&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      navlist: [</span><br><span class="line">        &#123; id: 1, title: &quot;电影&quot;, path: &quot;&#x2F;films&quot;, icon: &quot;icon-dianying&quot; &#125;,</span><br><span class="line">        &#123; id: 2, title: &quot;影院&quot;, path: &quot;&#x2F;cinema&quot;, icon: &quot;icon-yingyuan&quot; &#125;,</span><br><span class="line">        &#123; id: 3, title: &quot;资讯&quot;, path: &quot;&#x2F;news&quot;, icon: &quot;icon-zixun&quot; &#125;,</span><br><span class="line">        &#123; id: 4, title: &quot;我的&quot;, path: &quot;&#x2F;mine&quot;, icon: &quot;icon-wode&quot; &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">li &#123;</span><br><span class="line">  list-style: none;</span><br><span class="line">&#125;</span><br><span class="line">.router-link-active &#123;</span><br><span class="line">  color: #ff5f16;</span><br><span class="line">&#125;</span><br><span class="line">nav &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  bottom: 0px;</span><br><span class="line">  left: 0;</span><br><span class="line">  height: 1rem;</span><br><span class="line">  width: 7.5rem;</span><br><span class="line">  margin-left: 0px;</span><br><span class="line">  font-size: 0.24rem;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  text-align: center;</span><br><span class="line">  z-index: 2;</span><br><span class="line">  i &#123;</span><br><span class="line">    font-size: 0.44rem;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure></div>
<h3 id="第二步-使用"><a href="#第二步-使用" class="headerlink" title="第二步-使用"></a>第二步-使用</h3><p>src/App.vue，因为大部分页面都有，所以直接放在App.vue里了</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;bottomBar&gt;&lt;&#x2F;bottomBar&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import bottomBar from &quot;@&#x2F;components&#x2F;bottomBar&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    bottomBar</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure></div>
<h3 id="第三步-加状态"><a href="#第三步-加状态" class="headerlink" title="第三步-加状态"></a>第三步-加状态</h3><p>有些没有底部导航栏，所有我们要给他一个显示/隐藏的状态，<br><strong>1.App.vue里变加上v-show：</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line">    &lt;bottomBar v-show&#x3D;&quot;isBottom&quot;&gt;&lt;&#x2F;bottomBar&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure></div>

<p><strong>2.src/store/module/bottomBarModule.js，即分仓库里写上状态和方法</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">module</span> = &#123;</span><br><span class="line">  namespaced: <span class="literal">true</span>, <span class="comment">//开启命名空间</span></span><br><span class="line">  state: &#123;</span><br><span class="line">    isBottom: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    show(state) &#123;</span><br><span class="line">      state.isBottom = <span class="literal">true</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    hide(state) &#123;</span><br><span class="line">      state.isBottom = <span class="literal">false</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="built_in">module</span></span><br></pre></td></tr></table></figure></div>

<p><strong>3.src/store/index.js，总仓库里汇总分仓库</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> bottombar <span class="keyword">from</span> <span class="string">"./module/bottomBarModule"</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  modules: &#123;</span><br><span class="line">    cinema, <span class="comment">//影院的模块</span></span><br><span class="line">    bottombar, <span class="comment">//tabbar的模块</span></span><br><span class="line">    city <span class="comment">//城市的模块</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<p><strong>4./srcmain.js，把总仓库导出到全局</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  store, <span class="comment">//各组件就能用$store</span></span><br><span class="line">&#125;).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></table></figure></div>

<p><strong>5.在所有组件中，都可以用仓库里的东西了，但是建议用辅助函数</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState, mapGetters, mapActions, mapMutations &#125; <span class="keyword">from</span> <span class="string">"vuex"</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">      ...mapMutations(<span class="string">"bottombar"</span>, [<span class="string">"show"</span>]), <span class="comment">//调用bottombar的方法</span></span><br><span class="line">      ...mapMutations(<span class="string">"bottombar"</span>, [<span class="string">"hide"</span>])</span><br><span class="line">    &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">      <span class="comment">// 直接改变仓库里的数据，和下面一样效果，但是不建议这么做</span></span><br><span class="line">      <span class="comment">// this.$store.state.isBottom = false;</span></span><br><span class="line">      <span class="keyword">this</span>.hide(); <span class="comment">//底部导航栏消失</span></span><br><span class="line">    &#125;,</span><br><span class="line">    destroyed() &#123;</span><br><span class="line">      <span class="comment">// this.$store.state.isBottom = true;</span></span><br><span class="line">      <span class="keyword">this</span>.show(); <span class="comment">//底部导航栏出现</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="正在热映页面"><a href="#正在热映页面" class="headerlink" title="正在热映页面"></a>正在热映页面</h2><p>请求数据=&gt;v-for渲染=&gt;调样式这一套，没什么好讲的<br><strong>过滤器filter的使用</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 竖线表示引用filter过滤器，filter可以放组件里，也可以放src/utils/filters.js里</span></span><br><span class="line"><span class="comment">// 调用过滤器</span></span><br><span class="line">&lt;span&gt;主演：&#123;&#123;film.actors|actorFilter&#125;&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">import Vue from "vue";</span></span><br><span class="line"><span class="regexp">Vue.filter("actorFilter", data =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  if (data) &#123;</span></span><br><span class="line"><span class="regexp">    return data.map(item =&gt; item.name).join(" ");</span></span><br><span class="line"><span class="regexp">  &#125; else &#123;</span></span><br><span class="line"><span class="regexp">    return "暂无主演";</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure></div>

<p><strong>moment-时间格式化插件</strong><br>因为传数据时，时间格式不可能是“2020-3-20”的格式，一般会转为一串数字，我们前端使用时就要重新转化为标准格式；<br>1.yarn add moment -S 安装<br>2.定义过滤器</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span></span><br><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">"moment"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义日期的过滤器，option可以定义分割符号</span></span><br><span class="line">dateFilter(num)&#123;</span><br><span class="line">  Vue.filter(<span class="string">"dateFilter"</span>,(date,option=num)=&gt;&#123;</span><br><span class="line">      <span class="keyword">return</span> moment(date*<span class="number">1000</span>).format(<span class="string">"YYYY"</span>+option+<span class="string">"MM"</span>+option+<span class="string">"DD"</span>); <span class="comment">//moment里面的参数是时间戳</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>3.使用</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;&#123;&#123;filmInfo.premiereAt | dateFilter(<span class="string">"-"</span>)&#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="详情页页面"><a href="#详情页页面" class="headerlink" title="详情页页面"></a>详情页页面</h2><p>首先是动态接口，就是上面第五大节的 配置路由=&gt;其他配置=&gt;动态路由；<br>其次是渲染和布局；<br>其他难点：返回按钮，下拉后出现的顶部框，展开收缩的文本框，演职人员轮播图，剧照页面</p>
<h3 id="返回按钮"><a href="#返回按钮" class="headerlink" title="返回按钮"></a>返回按钮</h3><p>方案一：src/utils/directives.js/，写一个返回的指令，<code>v-back=&quot;{this:this}&quot;</code>调用；<br>这里this是传了一个vue实例对象；</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 后退的指令</span></span><br><span class="line">Vue.directive(<span class="string">"back"</span>, &#123;</span><br><span class="line">  inserted(el, binding, vnode) &#123;</span><br><span class="line">    el.style.backgroundColor =</span><br><span class="line">      el.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        binding.value.this._self.$router.go(<span class="number">-1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<p>方案二：直接本页面一个handleBack()函数，</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">handleBack() &#123;</span><br><span class="line">  <span class="keyword">this</span>.$router.back();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></div>

<h3 id="下拉后出现的顶部框"><a href="#下拉后出现的顶部框" class="headerlink" title="下拉后出现的顶部框"></a>下拉后出现的顶部框</h3><p>1.顶部框照常写，<br>2.src/utils/directives.js，写一个指令</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 滚动时出现的指令</span></span><br><span class="line">Vue.directive(<span class="string">"title"</span>, &#123;</span><br><span class="line">  <span class="comment">//插入到dom之后的钩子函数</span></span><br><span class="line">  inserted(el, binding) &#123;</span><br><span class="line">    el.style.display = <span class="string">"none"</span>;</span><br><span class="line">    <span class="built_in">window</span>.onscroll = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        (<span class="built_in">document</span>.body.scrollTop || <span class="built_in">document</span>.documentElement.scrollTop) &gt;</span><br><span class="line">        binding.value</span><br><span class="line">      ) &#123;</span><br><span class="line">        el.style.display = <span class="string">"block"</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        el.style.display = <span class="string">"none"</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//指令的解绑的钩子函数</span></span><br><span class="line">  unbind() &#123;</span><br><span class="line">    <span class="built_in">window</span>.onscroll = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>
<p>3.<code>v-title=&quot;50&quot;</code>即可调用，里面的数字表示下拉到50px才会出现</p>
<h3 id="展开收缩的文本框"><a href="#展开收缩的文本框" class="headerlink" title="展开收缩的文本框"></a>展开收缩的文本框</h3><p>利用css样式，由于每个简介内容都不同，所以高度要设置成max-height<br>注意：当两个属性相同时(max-height)，才会触发transition</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.jianjie</span> &#123;</span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">2rem</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.5s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.jianjie</span><span class="selector-class">.active</span> &#123;</span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">0.76rem</span>;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.5s</span> ease;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="演职人员轮播图"><a href="#演职人员轮播图" class="headerlink" title="演职人员轮播图"></a>演职人员轮播图</h3><p>v-swiper就完事了，free表示其他swiper属性</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"actor"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h4</span>&gt;</span>演职人员<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Swiper</span> <span class="attr">cName</span>=<span class="string">"actors"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-for</span>=<span class="string">"(data,index) in filmInfo.actors"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:key</span>=<span class="string">"data.name"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"swiper-slide"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-swiper</span>=<span class="string">"&#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">        current:index,</span></span></span><br><span class="line"><span class="tag"><span class="string">        length:filmInfo.actors.length?filmInfo.actors.length:0,</span></span></span><br><span class="line"><span class="tag"><span class="string">        swipe:'actors',</span></span></span><br><span class="line"><span class="tag"><span class="string">        free:&#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">          slidesPerView: 4,</span></span></span><br><span class="line"><span class="tag"><span class="string">          spaceBetween: 10,</span></span></span><br><span class="line"><span class="tag"><span class="string">          freeMode: true</span></span></span><br><span class="line"><span class="tag"><span class="string">        &#125;   </span></span></span><br><span class="line"><span class="tag"><span class="string">      &#125;"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">"data.avatarAddress"</span> <span class="attr">alt</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"name"</span>&gt;</span>&#123;&#123;data.name&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"role"</span>&gt;</span>&#123;&#123;data.role&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Swiper</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="剧照页面"><a href="#剧照页面" class="headerlink" title="剧照页面"></a>剧照页面</h3><p>剧照和电影详情其实是一个页面，所以要用v-if判断是否显示，<br>detail.vue中，<code>&lt;photo&gt;</code>是局部组件，别忘了引入和注册，list是传过去的照片数据</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"!istext"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">photo</span> @<span class="attr">event</span>=<span class="string">"previewImg"</span> <span class="attr">:list</span>=<span class="string">"filmInfo.photos"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 下拉才会出现的顶部框 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">m-title</span> @<span class="attr">back</span>=<span class="string">"handleBack2"</span>&gt;</span>剧照（&#123;&#123;filmInfo.photos?filmInfo.photos.length:0&#125;&#125;）<span class="tag">&lt;/<span class="name">m-title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">photo</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>photo.vue中，<br>previewImg是vant的图片，这里是调用了父组件detail里的previewImg方法，<br>@click =&gt; previewImg(index) =&gt; @event =&gt; previewImg，index表示当前照片的索引</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;myphoto&quot;&gt;</span><br><span class="line">    &lt;slot&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;li @click&#x3D;&quot;previewImg(index)&quot; v-for&#x3D;&quot;(data,index) in list&quot; :key&#x3D;&quot;data&quot;&gt;</span><br><span class="line">        &lt;img :src&#x3D;&quot;data&quot; alt &#x2F;&gt;</span><br><span class="line">      &lt;&#x2F;li&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Vue from &quot;vue&quot;;</span><br><span class="line">import &#123; ImagePreview &#125; from &quot;vant&quot;;</span><br><span class="line">Vue.use(ImagePreview);</span><br><span class="line">export default &#123;</span><br><span class="line">  props: [&quot;list&quot;],</span><br><span class="line">  methods: &#123;</span><br><span class="line">    previewImg(index) &#123;</span><br><span class="line">      this.$emit(&quot;event&quot;, index);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure></div>

<h3 id="定义数据注意"><a href="#定义数据注意" class="headerlink" title="定义数据注意"></a>定义数据注意</h3><p>详情页面的数据我们采用filmInfo:null的形式。<br>因为初始化的时候，如果定义filmInfo:{}。那么这个filmInfo.filmType是undefined，后续获取filmInfo.filmType.name的属性会报错。<br>所以需要通过v-if=”filmInfo”来做判断，开始的时候filmInfo是null，所以dom不会显示出来，后续ajax异步获取到数据了，然后进行filmInfo的赋值操作，这样的话，那v-if=”filmInfo”就会使得dom节点出现了。</p>
<h1 id="影院页面"><a href="#影院页面" class="headerlink" title="影院页面"></a>影院页面</h1><p>难点，切换城市、切换地区、搜索影院，</p>
<h2 id="影院列表"><a href="#影院列表" class="headerlink" title="影院列表"></a>影院列表</h2><p>影院列表是与城市/地区相关的，所以状态要存在分仓库里，仓库里有“影院列表/城市ID”两个数据，“getCinemaActions/spliceList”两个方法，<br><strong>src/store/module/cinemaModule.js里：</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  instance</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"@/utils/http"</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">module</span> = &#123;</span><br><span class="line">  namespaced: <span class="literal">true</span>, <span class="comment">//开启命名空间</span></span><br><span class="line">  state: &#123;</span><br><span class="line">    cinemaList: <span class="literal">null</span>, <span class="comment">//影院数据</span></span><br><span class="line">    cityId: <span class="number">310100</span> <span class="comment">//城市ID</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 截取5条电影院列表，搜索页面用到</span></span><br><span class="line">  getters: &#123;</span><br><span class="line">    spliceList(state) &#123;</span><br><span class="line">      <span class="keyword">if</span> (state.cinemaList) &#123;</span><br><span class="line">        <span class="keyword">return</span> state.cinemaList.splice(<span class="number">0</span>, <span class="number">6</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    getCinemaActions(store, cityId) &#123;</span><br><span class="line">      <span class="comment">//请求maizuo的接口数据</span></span><br><span class="line">      instance</span><br><span class="line">        .get(<span class="string">"/gateway?cityId="</span> + cityId + <span class="string">"&amp;ticketFlag=1&amp;k=5873362"</span>, &#123;</span><br><span class="line">          headers: &#123;</span><br><span class="line">            <span class="comment">//将数据放在请求头上面携带给卖座接口</span></span><br><span class="line">            <span class="string">"X-Host"</span>: <span class="string">"mall.film-ticket.cinema.list"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 因为改变状态要在mutations，所以要触发里面的函数</span></span><br><span class="line">          store.commit(<span class="string">"setCinemaList"</span>, res.data.data.cinemas)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    setCinemaList(state, data) &#123;</span><br><span class="line">      state.cinemaList = data</span><br><span class="line">    &#125;,</span><br><span class="line">    setCityid(state, id) &#123;</span><br><span class="line">      state.cityId = id</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="built_in">module</span></span><br></pre></td></tr></table></figure></div>

<p><strong>src/views/cinema.vue，表示每次切换到这个组件都会渲染数据，而这些数据会影响 城市/地区/影院列表</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">  <span class="keyword">this</span>.getCinemaActions(<span class="keyword">this</span>.cityId);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="城市列表"><a href="#城市列表" class="headerlink" title="城市列表"></a>城市列表</h2><p>使用vant布局，需要两个数据，右侧A-Z数组，左侧A-Z城市数组；<br>当点击某一列城市时，cinema仓库里对应的 城市名称/ID 也会改变，再跳到影院列表重新请求数据，影院列表就会改变了<br><strong>src/views/City.vue</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import Vue from &quot;vue&quot;;</span><br><span class="line">import &#123; IndexBar, IndexAnchor, Cell &#125; from &quot;vant&quot;;</span><br><span class="line">import &#123; mapMutations &#125; from &quot;vuex&quot;;</span><br><span class="line">Vue.use(IndexBar);</span><br><span class="line">Vue.use(IndexAnchor);</span><br><span class="line">Vue.use(Cell);</span><br><span class="line"></span><br><span class="line">import &#123; instance &#125; from &quot;@&#x2F;utils&#x2F;http&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      dataList: [],</span><br><span class="line">      indexList: []</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    &#x2F;&#x2F; 请求数据</span><br><span class="line">    instance(&quot;&#x2F;gateway?k&#x3D;6077446&quot;, &#123;</span><br><span class="line">      headers: &#123;</span><br><span class="line">        &quot;X-Host&quot;: &quot;mall.film-ticket.city.list&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;).then(res &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; console.log(res.data.data.cities);</span><br><span class="line">      this.dataFilter(res.data.data.cities);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    &#x2F;&#x2F; 解析仓库中的数据</span><br><span class="line">    ...mapMutations(&quot;city&quot;, [&quot;setCityName&quot;]),</span><br><span class="line">    ...mapMutations(&quot;cinema&quot;, [&quot;setCityid&quot;]),</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;修改vuex的共享状态 城市数据</span><br><span class="line">    handleClick(item) &#123;</span><br><span class="line">      this.setCityName(item.name);</span><br><span class="line">      this.setCityid(item.cityId);</span><br><span class="line">      this.$router.push(&quot;&#x2F;cinema&quot;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 这个函数得到A-Z的数组，以及A-Z对应的城市</span><br><span class="line">    dataFilter(cities) &#123;</span><br><span class="line"></span><br><span class="line">      &#x2F;&#x2F; A-Z的数组</span><br><span class="line">      let letterArr &#x3D; [];</span><br><span class="line">      for (var i &#x3D; 65; i &lt; 91; i++) &#123;</span><br><span class="line">        letterArr.push(String.fromCharCode(i));</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &#x2F;&#x2F;filtr 遍历26个字母，跟cities数据.pinyin.首字母.大写 进行过滤</span><br><span class="line">      var cityArr &#x3D; [];</span><br><span class="line">      for (var j &#x3D; 0; j &lt; letterArr.length; j++) &#123;</span><br><span class="line">        let tempArr &#x3D; cities.filter(</span><br><span class="line">          item &#x3D;&gt; item.pinyin.substring(0, 1).toUpperCase() &#x3D;&#x3D;&#x3D; letterArr[j]</span><br><span class="line">        );</span><br><span class="line">        if (tempArr.length &gt; 0) &#123;</span><br><span class="line">          &#x2F;&#x2F;如果cities里面pinyin里面有大写字母</span><br><span class="line">          cityArr.push(&#123;</span><br><span class="line">            index: letterArr[j],</span><br><span class="line">            list: tempArr</span><br><span class="line">          &#125;);</span><br><span class="line">          &#x2F;&#x2F;设置右侧自定义索引里面push22个英文字母</span><br><span class="line">          this.indexList.push(letterArr[j]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      &#x2F;&#x2F;给左侧遍历的数据赋值</span><br><span class="line">      this.dataList &#x3D; cityArr;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;city&quot;&gt;</span><br><span class="line">    &lt;van-index-bar :index-list&#x3D;&quot;indexList&quot;&gt;</span><br><span class="line">      &lt;div v-for&#x3D;&quot;(data,index) in dataList&quot; :key&#x3D;&quot;index&quot;&gt;</span><br><span class="line">        &lt;van-index-anchor :index&#x3D;&quot;data.index&quot; &#x2F;&gt;</span><br><span class="line">        &lt;van-cell</span><br><span class="line">          @click&#x3D;&quot;handleClick(item)&quot;</span><br><span class="line">          :key&#x3D;&quot;index&quot;</span><br><span class="line">          v-for&#x3D;&quot;(item,index) in data.list&quot;</span><br><span class="line">          :title&#x3D;&quot;item.name&quot;</span><br><span class="line">        &#x2F;&gt;</span><br><span class="line">      &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;van-index-bar&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure></div>

<h2 id="地区列表"><a href="#地区列表" class="headerlink" title="地区列表"></a>地区列表</h2><p>这里其实是在src/views/cinema.vue完成的；<br>经过下面的计算后，直接根据<code>computedDistrict</code>渲染地区列表；<br>点击某个地区后根据<code>computedDatalist</code>，匹配出处于该地区的影院，再改变仓库里的cinemaList；<br><strong>实际上影院列表是根据computedDatalist来渲染</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">    <span class="comment">//这是直接拿到了公共仓库里的cinemaList，后面直接this.cinemaList就能用了</span></span><br><span class="line">    ...mapState(<span class="string">"cinema"</span>, [<span class="string">"cinemaList"</span>]),</span><br><span class="line">    ...mapState(<span class="string">"cinema"</span>, [<span class="string">"cityId"</span>]),</span><br><span class="line">    ...mapState(<span class="string">"city"</span>, [<span class="string">"cityName"</span>]),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据仓库里的cinemaList得到当前城市的地区，在前面加上全城</span></span><br><span class="line">    computedDistrict() &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.cinemaList) &#123;</span><br><span class="line">        <span class="keyword">let</span> newArr = <span class="keyword">this</span>.cinemaList.map(<span class="function"><span class="params">item</span> =&gt;</span> item.districtName);</span><br><span class="line">        newArr = <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(newArr));</span><br><span class="line">        newArr.unshift(<span class="string">"全城"</span>);</span><br><span class="line">        <span class="keyword">return</span> newArr;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据current区域，过滤出相应区域的影城</span></span><br><span class="line">    <span class="comment">//例如选择是金山区区域，那么数组过滤出新的数组，这个新数组里面全部放着就是金山区的所有的影院了</span></span><br><span class="line">    computedDatalist() &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.currentQ === <span class="string">"全城"</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.cinemaList;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.cinemaList.filter(</span><br><span class="line">        item =&gt; item.districtName === <span class="keyword">this</span>.currentQ</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>src/store/module/cinemaModule里</strong><br>存有 影院列表/城市ID 两个公共数据，影院页面是根据“影院列表”渲染的，当在左上角的列表里选择一个城市后，把城市ID传到cinemaModule里，这里就会携带此ID再次请求，改变了Module里的数据，影院列表显示的数据也会相应改变</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  instance</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"@/utils/http"</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">module</span> = &#123;</span><br><span class="line">  namespaced: <span class="literal">true</span>, <span class="comment">//开启命名空间</span></span><br><span class="line">  state: &#123;</span><br><span class="line">    cinemaList: <span class="literal">null</span>, <span class="comment">//影院数据</span></span><br><span class="line">    cityId: <span class="number">310100</span> <span class="comment">//城市ID</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 截取5条电影院列表，搜索页面用到</span></span><br><span class="line">  getters: &#123;</span><br><span class="line">    spliceList(state) &#123;</span><br><span class="line">      <span class="keyword">if</span> (state.cinemaList) &#123;</span><br><span class="line">        <span class="keyword">return</span> state.cinemaList.splice(<span class="number">0</span>, <span class="number">6</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    getCinemaActions(store, cityId) &#123;</span><br><span class="line">      <span class="comment">//请求maizuo的接口数据</span></span><br><span class="line">      instance</span><br><span class="line">        .get(<span class="string">"/gateway?cityId="</span> + cityId + <span class="string">"&amp;ticketFlag=1&amp;k=5873362"</span>, &#123;</span><br><span class="line">          headers: &#123;</span><br><span class="line">            <span class="comment">//将数据放在请求头上面携带给卖座接口</span></span><br><span class="line">            <span class="string">"X-Host"</span>: <span class="string">"mall.film-ticket.cinema.list"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 因为改变状态要在mutations，所以要触发里面的函数</span></span><br><span class="line">          store.commit(<span class="string">"setCinemaList"</span>, res.data.data.cinemas)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    setCinemaList(state, data) &#123;</span><br><span class="line">      state.cinemaList = data</span><br><span class="line">    &#125;,</span><br><span class="line">    setCityid(state, id) &#123;</span><br><span class="line">      state.cityId = id</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="built_in">module</span></span><br></pre></td></tr></table></figure></div>
<p><strong>src/views/cinema.vue中：</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入辅助函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState, mapActions &#125; <span class="keyword">from</span> <span class="string">"vuex"</span>;</span><br><span class="line"><span class="comment">// 通过辅助函数解析cinema仓库里的方法</span></span><br><span class="line">...mapActions(<span class="string">"cinema"</span>, [<span class="string">"getCinemaActions"</span>])</span><br><span class="line"><span class="comment">// 调用这个方法</span></span><br><span class="line"><span class="keyword">this</span>.getCinemaActions(<span class="keyword">this</span>.cityId);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 后续根据cinemaList渲染就行了</span></span><br><span class="line">...mapState(<span class="string">"cinema"</span>, [<span class="string">"cinemaList"</span>])</span><br></pre></td></tr></table></figure></div>


<h2 id="搜索页面"><a href="#搜索页面" class="headerlink" title="搜索页面"></a>搜索页面</h2><p>分为三部分：一开始展示离你最近/搜到后展示影院列表/搜不到展示找不到的图片；<br>先给第一部分的input框一个v-model=”mytext”属性，后面两部分通过v-show=”mytext”来判断是否显示，即input框里有内容则显示后面两部分，没有内容则显示离你最近；离你最近通过公关仓库的spliceList()获取数据就能渲染了；<br>第二第三部分是互斥的，通过v-else判断是否显示，还有一点要注意的就是搜索功能<br>src/views/search</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  <span class="comment">//这是直接拿到了公共仓库里的cinemaList，后面直接this.cinemaList就能用了</span></span><br><span class="line">  ...mapState(<span class="string">"cinema"</span>, [<span class="string">"cinemaList"</span>]),</span><br><span class="line"></span><br><span class="line">  searchDatalist() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.cinemaList) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.cinemaList.filter(</span><br><span class="line">        item =&gt;</span><br><span class="line">          <span class="comment">// 这里只检索了名字 </span></span><br><span class="line">          item.name.includes(<span class="keyword">this</span>.mytext) ||</span><br><span class="line">          item.name.toUpperCase().includes(<span class="keyword">this</span>.mytext.toUpperCase()) ||</span><br><span class="line">          item.name.toLowerCase().includes(<span class="keyword">this</span>.mytext.toLowerCase())</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">mounted() &#123;</span><br><span class="line">  <span class="keyword">this</span>.hide(); <span class="comment">//底部导航栏消失</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.cinemaList) &#123;</span><br><span class="line">    <span class="comment">// 如果仓库里已经有cinemaList，就直接拿来渲染</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果还没有cinemaList，通过仓库的方法请求数据</span></span><br><span class="line">    <span class="keyword">this</span>.getCinemaActions(<span class="keyword">this</span>.cityId);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">destroyed() &#123;</span><br><span class="line">  <span class="keyword">this</span>.show(); <span class="comment">//底部导航栏出现</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="vuex"><a href="#vuex" class="headerlink" title="vuex"></a>vuex</h1><p>vuex就是一个公共仓库，里面存有各组件都能用的数据或方法</p>
<h2 id="下面举个栗子："><a href="#下面举个栗子：" class="headerlink" title="下面举个栗子："></a>下面举个栗子：</h2><p><strong>/src/store/module/bottomBarModule.js，分仓库-定义子组件要用到的数据/方法</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">module</span> = &#123;</span><br><span class="line">  namespaced: <span class="literal">true</span>, <span class="comment">//开启命名空间</span></span><br><span class="line">  state: &#123;</span><br><span class="line">    isBottom: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    show(state) &#123;</span><br><span class="line">      state.isBottom = <span class="literal">true</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    hide(state) &#123;</span><br><span class="line">      state.isBottom = <span class="literal">false</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="built_in">module</span></span><br></pre></td></tr></table></figure></div>

<p><strong>/src/store/index.js，总仓库-汇总分仓库</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> bottombar <span class="keyword">from</span> <span class="string">"./module/bottomBarModule"</span></span><br><span class="line"><span class="keyword">import</span> cinema <span class="keyword">from</span> <span class="string">"./module/cinemaModule"</span></span><br><span class="line"><span class="keyword">import</span> city <span class="keyword">from</span> <span class="string">"./module/citymodule"</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123; <span class="comment">//用来定义共享状态</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">//对于state进行相关的处理，根据这个state里面的共享状态派发新的状态</span></span><br><span class="line">  <span class="comment">//类似于 vue当中的计算属性的概念</span></span><br><span class="line">  getters: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  actions: &#123; <span class="comment">//实现异步请求操作  后续触发getCinemaActions ==&gt;进行异步api请求获取数据==&gt; commit提交具体mutations==&gt; mutation内部才可以同步的更改状态</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  mutations: &#123; <span class="comment">//存放了所有更改状态的方法</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  modules: &#123;</span><br><span class="line">    cinema, <span class="comment">//影院的模块</span></span><br><span class="line">    bottombar, <span class="comment">//tabbar的模块</span></span><br><span class="line">    city <span class="comment">//城市的模块</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<p><strong>各组件中，通过辅助函数使用仓库里的数据/方法</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState, mapGetters, mapActions, mapMutations &#125; <span class="keyword">from</span> <span class="string">"vuex"</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    ...mapMutations(<span class="string">"bottombar"</span>, [<span class="string">"show"</span>]),</span><br><span class="line">    ...mapMutations(<span class="string">"bottombar"</span>, [<span class="string">"hide"</span>])</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    <span class="keyword">this</span>.hide()</span><br><span class="line">  &#125;,</span><br><span class="line">  destroyed() &#123;</span><br><span class="line">    <span class="keyword">this</span>.show()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<h2 id="vuex持久化存储"><a href="#vuex持久化存储" class="headerlink" title="vuex持久化存储"></a>vuex持久化存储</h2><p>vuex的 数据/方法 默认是存在缓存里的，页面一刷新就会消失，但是我们想要用户刷新时 城市/地区 等数据保持不变，可以手动把vuex的数据存到浏览器的LocalStorage，也可以借助插件自动存储。<br><strong>vuex-persistedstate</strong><br>1.yarn add vuex-persistedstate -S<br>2.src/router/index.js，</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一步引入</span></span><br><span class="line"><span class="keyword">import</span> createPersistedState <span class="keyword">from</span> <span class="string">"vuex-persistedstate"</span>;</span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 第二步使用插件,</span></span><br><span class="line">  plugins: [createPersistedState(&#123;</span><br><span class="line">    reducer(data) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        city: data.city,</span><br><span class="line">        cinema: data.cinema</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)],</span><br><span class="line"></span><br><span class="line">  modules: &#123;</span><br><span class="line">    cinema, <span class="comment">//影院的模块</span></span><br><span class="line">    bottombar, <span class="comment">//tabbar的模块</span></span><br><span class="line">    city <span class="comment">//城市的模块</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<h2 id="利用vuex优化请求次数"><a href="#利用vuex优化请求次数" class="headerlink" title="利用vuex优化请求次数"></a>利用vuex优化请求次数</h2><p>目前，我们每点击一次电影/影院都会请求一次，可以用vuex来优化；<br>前面我们已经把city/cinema仓库里的数据存到LocalStorage里了，在请求数据时就可以做判断，如果已经有cinemaList就不请求：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.cinemaList.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="comment">// 如果有数据就不请求了，直接使用缓存vuex的数据</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">this</span>.getCinemaActions(<span class="keyword">this</span>.cityId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>但是加了这个判断后，再切换城市回到cinemaList页面，程序就发现vuex有数据，不会再次请求从而更新数据了。因此我们需要在前往 切换城市 页面时把数据清空：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 前往搜索的按钮</span></span><br><span class="line">handleChangePage(path) &#123;</span><br><span class="line">  <span class="keyword">if</span> (path === <span class="string">"/cinema/city"</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setCinemaList([]);</span><br><span class="line">    <span class="keyword">this</span>.setFilmList1([]);</span><br><span class="line">    <span class="keyword">this</span>.setFilmList2([]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">this</span>.$router.push(path);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>以此类推，只要数据需要更新，就得先把数据清空；不需要更新就不用清空，直接用缓存里的数据</p>
<h1 id="transition"><a href="#transition" class="headerlink" title="transition"></a>transition</h1><p>利用vue的transition实现组件转场过渡，<br><strong>src/App.vue中：</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 路由插槽 --&gt;</span><br><span class="line">    &lt;transition name&#x3D;&quot;app&quot; mode&#x3D;&quot;out-in&quot;&gt;</span><br><span class="line">      &lt;router-view&gt;&lt;&#x2F;router-view&gt;</span><br><span class="line">    &lt;&#x2F;transition&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.app-enter-active &#123;</span><br><span class="line">  animation: move 0.5s;</span><br><span class="line">&#125;</span><br><span class="line">.app-leave-active &#123;</span><br><span class="line">  animation: move 0.5s reverse;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@keyframes move &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    opacity: 0;</span><br><span class="line">    transform: translateY(50px);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    opacity: 1;</span><br><span class="line">    transform: translateY(0px);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure></div>

<h1 id="vant"><a href="#vant" class="headerlink" title="vant"></a>vant</h1><p>1.安装vant：<code>yarn add vant -S</code>，<br>2.安装插件：<code>yarn add babel-plugin-import -D</code>，<br>3.新建babel.config.js：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [</span><br><span class="line">    <span class="string">'@vue/cli-plugin-babel/preset'</span></span><br><span class="line">  ],</span><br><span class="line">  plugins: [</span><br><span class="line">    [<span class="string">'import'</span>, &#123;</span><br><span class="line">      libraryName: <span class="string">'vant'</span>,</span><br><span class="line">      libraryDirectory: <span class="string">'es'</span>,</span><br><span class="line">      style: <span class="literal">true</span></span><br><span class="line">    &#125;, <span class="string">'vant'</span>]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>4.使用也分为三步：引入=&gt;写标签=&gt;相关配置</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 第二步,不一定有 --&gt;</span><br><span class="line">  &lt;form @submit.prevent&#x3D;&quot;login&quot;&gt;</span><br><span class="line">    &lt;van-field v-model&#x3D;&quot;username&quot; label&#x3D;&quot;用户:&quot; &#x2F;&gt;</span><br><span class="line">    &lt;van-field v-model&#x3D;&quot;password&quot; type&#x3D;&quot;password&quot; label&#x3D;&quot;密码：&quot; &#x2F;&gt;</span><br><span class="line">    &lt;van-button type&#x3D;&quot;primary&quot;&gt;登录&lt;&#x2F;van-button&gt;</span><br><span class="line">  &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">&#x2F;&#x2F; 第一步</span><br><span class="line">import Vue from &#39;vue&#39;;</span><br><span class="line">import &#123; Button,Field,Dialog  &#125; from &#39;vant&#39;;</span><br><span class="line">Vue.use(Button);</span><br><span class="line">Vue.use(Field);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 第三步，某些时候需要配置，具体看文档</span><br><span class="line">export&#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    previewImg(index) &#123;</span><br><span class="line">      ImagePreview(&#123;</span><br><span class="line">        images: this.filmInfo.photos,</span><br><span class="line">        startPosition: index,</span><br><span class="line">        closeable: true,</span><br><span class="line">        closeIconPosition: &quot;top-left&quot;,</span><br><span class="line">        closeIcon:</span><br><span class="line">          &quot;https:&#x2F;&#x2F;ss0.bdstatic.com&#x2F;70cFuHSh_Q1YnxGkpoWK1HF6hhy&#x2F;it&#x2F;u&#x3D;3274958432,4178098164&amp;fm&#x3D;26&amp;gp&#x3D;0.jpg&quot;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure></div>

<h1 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h1><h2 id="影院列表页的滑动优化"><a href="#影院列表页的滑动优化" class="headerlink" title="影院列表页的滑动优化"></a>影院列表页的滑动优化</h2><p>1.yarn add better-scroll -S<br>2.组件中</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 影院列表 --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;list&quot; :style&#x3D;&quot;&#123;height:scrollHeight,overflow:&#39;hidden&#39;&#125;&quot;&gt;</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &lt;List v-for&#x3D;&quot;item in computedDatalist&quot; :key&#x3D;&quot;item.cinemaId&quot; :item&#x3D;&quot;item&quot;&gt;&lt;&#x2F;List&gt;</span><br><span class="line">      &lt;&#x2F;ul&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import BetterScroll from &quot;better-scroll&quot;;</span><br><span class="line"></span><br><span class="line">mounted() &#123;</span><br><span class="line">  this.scrollHeight &#x3D; document.documentElement.clientHeight - 95 - 50 + &quot;px&quot;;</span><br><span class="line">  &#x2F;&#x2F; 进行实例化操作</span><br><span class="line">  new BetterScroll(&quot;.list&quot;, &#123;</span><br><span class="line">    scrollbar: &#123;</span><br><span class="line">      fade: true</span><br><span class="line">    &#125;,</span><br><span class="line">    click: true &#x2F;&#x2F; 可以被点击了</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure></div>

<h1 id="上线"><a href="#上线" class="headerlink" title="上线"></a>上线</h1><h2 id="部署到阿里云服务器"><a href="#部署到阿里云服务器" class="headerlink" title="部署到阿里云服务器"></a>部署到阿里云服务器</h2><h2 id="Nginx代理"><a href="#Nginx代理" class="headerlink" title="Nginx代理"></a>Nginx代理</h2><p>1.本地项目的代理配置在vue.config，但是上线后这个文件就无效了，无效后我们自己的登录接口就无法访问(卖座的接口还可以访问)<br>2.<code>yarn build</code>后，把dist文件夹部署到服务器<br>3.本地dist/nginx.conf，http下的serve新增</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location /info/api &#123;</span><br><span class="line">   proxy_pass http:<span class="comment">//47.96.0.211:3000/api;  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>4.将本地的nginx.conf传到服务器，选择覆盖<br>5.关闭服务器，下一步重启<br>6.<code>ssh root@47.104.70.82</code> =&gt; cd / =&gt; cd user/local/nginx/sbin/ =&gt; ./nginx -s reload</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/hhh.github.io/2020/04/08/2020-4-8-nuxt/" rel="prev" title="nuxt服务端渲染">
      <i class="fa fa-chevron-left"></i> nuxt服务端渲染
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#项目简介"><span class="nav-number">1.</span> <span class="nav-text">项目简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#vue-cli"><span class="nav-number">2.</span> <span class="nav-text">vue-cli</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装vue-cli"><span class="nav-number">2.1.</span> <span class="nav-text">安装vue-cli</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建项目"><span class="nav-number">2.2.</span> <span class="nav-text">创建项目</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#vue-config配置"><span class="nav-number">3.</span> <span class="nav-text">vue.config配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#eslint"><span class="nav-number">3.1.</span> <span class="nav-text">eslint</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他"><span class="nav-number">3.2.</span> <span class="nav-text">其他</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#移动端注意事项"><span class="nav-number">4.</span> <span class="nav-text">移动端注意事项</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#配置路由"><span class="nav-number">5.</span> <span class="nav-text">配置路由</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#简单配置"><span class="nav-number">5.1.</span> <span class="nav-text">简单配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#路由完善"><span class="nav-number">5.2.</span> <span class="nav-text">路由完善</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-路由懒加载"><span class="nav-number">5.2.1.</span> <span class="nav-text">1.路由懒加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-多级路由"><span class="nav-number">5.2.2.</span> <span class="nav-text">2.多级路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-默认路由-命名路由-路由重定向"><span class="nav-number">5.2.3.</span> <span class="nav-text">3.默认路由&#x2F;命名路由&#x2F;路由重定向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-动态路由"><span class="nav-number">5.2.4.</span> <span class="nav-text">4.动态路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-路由跳转"><span class="nav-number">5.2.5.</span> <span class="nav-text">5.路由跳转</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-路由模式"><span class="nav-number">5.2.6.</span> <span class="nav-text">6.路由模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-路由守卫"><span class="nav-number">5.2.7.</span> <span class="nav-text">7.路由守卫</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#全局路由钩子"><span class="nav-number">5.2.7.1.</span> <span class="nav-text">全局路由钩子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#局部路由钩子"><span class="nav-number">5.2.7.2.</span> <span class="nav-text">局部路由钩子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#路由组件钩子"><span class="nav-number">5.2.7.3.</span> <span class="nav-text">路由组件钩子</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#登录与接口"><span class="nav-number">6.</span> <span class="nav-text">登录与接口</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-快速搭建接口"><span class="nav-number">6.1.</span> <span class="nav-text">1.快速搭建接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-反向代理解决跨域问题"><span class="nav-number">6.2.</span> <span class="nav-text">2.反向代理解决跨域问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-拦截"><span class="nav-number">6.3.</span> <span class="nav-text">3.拦截</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#首页页面"><span class="nav-number">7.</span> <span class="nav-text">首页页面</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#封装swiper"><span class="nav-number">7.1.</span> <span class="nav-text">封装swiper</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#第一步"><span class="nav-number">7.1.1.</span> <span class="nav-text">第一步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第二步"><span class="nav-number">7.1.2.</span> <span class="nav-text">第二步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三步"><span class="nav-number">7.1.3.</span> <span class="nav-text">第三步</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#封装底部导航栏"><span class="nav-number">7.2.</span> <span class="nav-text">封装底部导航栏</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#第一步-组件"><span class="nav-number">7.2.1.</span> <span class="nav-text">第一步-组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第二步-使用"><span class="nav-number">7.2.2.</span> <span class="nav-text">第二步-使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三步-加状态"><span class="nav-number">7.2.3.</span> <span class="nav-text">第三步-加状态</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正在热映页面"><span class="nav-number">7.3.</span> <span class="nav-text">正在热映页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#详情页页面"><span class="nav-number">7.4.</span> <span class="nav-text">详情页页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#返回按钮"><span class="nav-number">7.4.1.</span> <span class="nav-text">返回按钮</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#下拉后出现的顶部框"><span class="nav-number">7.4.2.</span> <span class="nav-text">下拉后出现的顶部框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#展开收缩的文本框"><span class="nav-number">7.4.3.</span> <span class="nav-text">展开收缩的文本框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#演职人员轮播图"><span class="nav-number">7.4.4.</span> <span class="nav-text">演职人员轮播图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#剧照页面"><span class="nav-number">7.4.5.</span> <span class="nav-text">剧照页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定义数据注意"><span class="nav-number">7.4.6.</span> <span class="nav-text">定义数据注意</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#影院页面"><span class="nav-number">8.</span> <span class="nav-text">影院页面</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#影院列表"><span class="nav-number">8.1.</span> <span class="nav-text">影院列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#城市列表"><span class="nav-number">8.2.</span> <span class="nav-text">城市列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#地区列表"><span class="nav-number">8.3.</span> <span class="nav-text">地区列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#搜索页面"><span class="nav-number">8.4.</span> <span class="nav-text">搜索页面</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#vuex"><span class="nav-number">9.</span> <span class="nav-text">vuex</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#下面举个栗子："><span class="nav-number">9.1.</span> <span class="nav-text">下面举个栗子：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vuex持久化存储"><span class="nav-number">9.2.</span> <span class="nav-text">vuex持久化存储</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#利用vuex优化请求次数"><span class="nav-number">9.3.</span> <span class="nav-text">利用vuex优化请求次数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#transition"><span class="nav-number">10.</span> <span class="nav-text">transition</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#vant"><span class="nav-number">11.</span> <span class="nav-text">vant</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#优化"><span class="nav-number">12.</span> <span class="nav-text">优化</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#影院列表页的滑动优化"><span class="nav-number">12.1.</span> <span class="nav-text">影院列表页的滑动优化</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#上线"><span class="nav-number">13.</span> <span class="nav-text">上线</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#部署到阿里云服务器"><span class="nav-number">13.1.</span> <span class="nav-text">部署到阿里云服务器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nginx代理"><span class="nav-number">13.2.</span> <span class="nav-text">Nginx代理</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="浩华好哇"
      src="/hhh.github.io/images/%E5%A4%B4%E5%83%8F.jpg">
  <p class="site-author-name" itemprop="name">浩华好哇</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/hhh.github.io/archives">
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/hhh.github.io/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>

    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=3&id=910200122&auto=1&height=66"></iframe>
  </aside>
  
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">浩华好哇</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">89k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:42</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>-->

<!--
  <span class="post-meta-divider">|</span>-->

<!--
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.0
  </div>-->

        








      </div>
    </footer>
  </div>

  
  <script src="/hhh.github.io/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="/hhh.github.io/lib/velocity/velocity.min.js"></script>
  <script src="/hhh.github.io/lib/velocity/velocity.ui.min.js"></script>

<script src="/hhh.github.io/js/utils.js"></script>

<script src="/hhh.github.io/js/motion.js"></script>


<script src="/hhh.github.io/js/schemes/pisces.js"></script>


<script src="/hhh.github.io/js/next-boot.js"></script>




  















  

  


  <script id="ribbon" size="400" alpha='0.3' zIndex="-2" src="js/canvas_ribbon.js"></script>
  <script id="ribbon" size="400" alpha='0.3' zIndex="-2" src="../js/canvas_ribbon.js"></script>

  <script src="https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js"></script>
  
  <!-- 点击爱心 -->
  <script src="js/clicklove.js"></script>
  <script src="../js/clicklove.js"></script>
</html>
